# Лабораторная работа №5. Работа с временным рядом
#### Данные отображают цены на акции компании 005930.KS на момент их закрытия.

### Загрузка данных

![1](https://user-images.githubusercontent.com/94290501/236832517-5d9472f3-3498-443d-b37d-4b3aa6409740.png)

### Построим график временного ряда

![2](https://user-images.githubusercontent.com/94290501/236832544-5149830f-bf92-4137-acd0-db4f7e701680.png)

График показывает, что цены на акции 005930.KS были в основном стабильны в начале периода. Однако, существует большое количество короткосрочных колебаний цен, которые не подчиняются общему тренду и вызваны внешними факторами.

На графике цен на момент закрытия акций компании 005930.KS, представленном выше, можно наблюдать общий тренд цен на протяжении всего периода.

#### Посмотрим на скользящее среднее

![3](https://user-images.githubusercontent.com/94290501/236832572-e0f9e08a-e870-4afd-8e2b-225045f69b26.png)

### Тест Дикки-Фуллера 

Проверим на уровне значимости 0.05

![4](https://user-images.githubusercontent.com/94290501/236832600-2294d1df-85f6-4182-804e-20fcef074d95.png)

![5](https://user-images.githubusercontent.com/94290501/236832626-da21e74d-9d47-44f3-ae9f-fedeebf1e738.png)

![Dickey-Fuller](https://user-images.githubusercontent.com/94290501/236833312-c655205a-1dd5-438d-99d5-97811eaaa025.png)

На основании теста Dickey-Fuller, можно сделать вывод о том, что временной ряд не является стационарным. Это подтверждается значением p-value, превышающим уровень значимости 0.05, и недостаточным значением тестовой статистики для отклонения от нулевой гипотезы о нестационарности ряда.

### Методология Бокса-Дженкинса.
#### ACF

![6](https://user-images.githubusercontent.com/94290501/236832646-3498e0ba-6ac5-4acf-aa45-e114f555ef2d.png)

![7](https://user-images.githubusercontent.com/94290501/236832665-6cc8916f-3177-4934-af6e-5645093d273b.png)

#### PACF

![8](https://user-images.githubusercontent.com/94290501/236832692-169cc41b-92bf-4be2-b861-cb9a9956b9fa.png)

![9](https://user-images.githubusercontent.com/94290501/236832704-efd3b10d-09b9-431c-bf6b-d99f40088ed8.png)

Это означает, что на 250 лаге автокорреляционная функция (ACF) последующие лаги становятся значимыми. Из графика PACF (Partial Autocorrelation Function) можно сделать вывод, что после второго лага все последующие лаги не являются значимыми, т.е. корреляция становится незначительной.

Результаты построение PACF и ACF не удовлетворительны. Сложно определить примерные значения p,q для построения ARIMA-модели. Предлагается для начала избавится от трендовой зависимости

### Удаления линейной трендовой составляющей из временного ряда

![10](https://user-images.githubusercontent.com/94290501/236832723-ab868005-3aaa-4740-acc2-635885dc25f3.png)

### Тест Дикки-Фуллера  без тренда

p-value = 0.1627. The series is likely non-stationary.

Хоть ряд и не является стационарным, результаты теста Дики-Фуллера показывают, что значение p-value уменьшилось. Это может свидетельствовать о том, что ряд стал более стационарным, чем раньше.
### Методология Бокса-Дженкинса без тренда

#### ACF

![11](https://user-images.githubusercontent.com/94290501/236832837-d6e7a5e5-1037-4fba-b618-0d861c2b8daa.png)

![12](https://user-images.githubusercontent.com/94290501/236832879-748a1b64-9f29-491e-917b-2bec2fccebb1.png)

#### PACF

![13](https://user-images.githubusercontent.com/94290501/236832896-a9237dd6-4c17-40cc-82ae-f2b6016d2eb7.png)

![14](https://user-images.githubusercontent.com/94290501/236832915-a0082128-4188-4f47-aa64-9ef52c40d5f6.png)

Зависимость цены акции от предыдущих значений снизилась, однако она все еще остается существенной.

### Разделяем на обучающую и тестовую выборки

Размер обучающей выборки: 2530

Размер тестовой выборки: 261

![15](https://user-images.githubusercontent.com/94290501/236832936-c6d5441b-e7da-45b5-a43b-793367c5df61.png)

Исходя из полученных результатов, можно сделать вывод, что модель ARIMA(6,0,5), которая учитывает тренд, дает более точные прогнозы, чем модель ARIMA(4,1,4) без тренда. Это можно объяснить тем, что в исходных данных присутствует заметный тренд, и учет тренда позволяет лучше описать структуру временного ряда.

### Проверим модель на тестовой выборке

![16](https://user-images.githubusercontent.com/94290501/236832949-b0371650-50f1-4142-a37e-da0a46a3c04a.png)

### Построим прогноз

![17](https://user-images.githubusercontent.com/94290501/236832989-c7026993-8f2d-4aaf-b77b-e1f11a9367d7.png)

Исходя из анализа графика, можно сделать вывод, что в будущем цены на акции компании 005930.KS скорее всего сначала снизяться, а потом пойдут вверх.

### Построение моделей для прогноза по разным периодам

![18](https://user-images.githubusercontent.com/94290501/236833008-a60c0149-e034-4e1f-8958-73a730e79d94.png)

Разделим исходные данные на 3 блока:

1) 2012.01.01 - 2015.10.06

2) 2015.10.06 - 2019.07.25

3) 2019.07.25 - н.в.

Из результатов моделирования видно, что лучшая модель на первом блоке данных имеет порядок (1,4,4) и достигает AIC на тренировочной выборке в размере 1390.77, а на тестовой - 1420.92. Лучшая модель на втором блоке данных имеет порядок (2,3,2) и достигает AIC на тренировочной выборке в размере 10.0, а на тестовой - 1517.68. Лучшая модель на третьем блоке данных имеет порядок (0,1,0) и достигает AIC на тренировочной выборке в размере 13834.18, а на тестовой - 1561.89.

Модель с наименьшим значением AIC на тестовой выборке является наиболее предпочтительной для прогнозирования будущих значений. Следовательно, на основе результатов моделирования можно сделать вывод, что наиболее точная модель на тестовой выборке была построена на первом блоке данных и имеет порядок (1,4,4).
